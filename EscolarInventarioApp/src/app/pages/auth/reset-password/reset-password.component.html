<div class="forgot-password-wrapper">
  <div class="forgot-password-card">
    <h2>Redefinir Senha</h2>

    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="input-group">
        <input
          [type]="showNewPassword ? 'text' : 'password'"
          formControlName="newPassword"
          placeholder="Nova Senha"
          required
        />
        <span class="icon toggle-password" (click)="toggleNewPasswordVisibility()">
          <i [class]="showNewPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
        </span>
      </div>

      <div class="error-list" *ngIf="newPassword.touched">
        <div *ngIf="newPassword.errors?.['required']">A senha é obrigatória.</div>
        <div *ngIf="newPassword.errors?.['minlength']">Mínimo de 8 caracteres.</div>
        <div *ngIf="!hasUppercase && newPassword.value">Precisa de uma maiúscula.</div>
        <div *ngIf="!hasLowercase && newPassword.value">Precisa de uma minúscula.</div>
        <div *ngIf="!hasNumber && newPassword.value">Precisa de um número.</div>
      </div>

      <div class="input-group">
        <input
          [type]="showConfirmPassword ? 'text' : 'password'"
          formControlName="confirmPassword"
          placeholder="Confirmar Senha"
          required
        />
        <span class="icon toggle-password" (click)="toggleConfirmPasswordVisibility()">
          <i [class]="showConfirmPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
        </span>
      </div>

      <div class="error" *ngIf="passwordsDontMatch && confirmPassword.touched">
        As senhas não coincidem.
      </div>

      <button
        type="submit"
        [disabled]="form.invalid || passwordsDontMatch || loading"
      >
        <span *ngIf="loading" class="spinner"></span>
        {{ loading ? 'Enviando...' : 'Redefinir Senha' }}
      </button>
    </form>
  </div>
</div>
